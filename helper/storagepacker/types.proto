syntax = "proto3";

package storagepacker;

import "google/protobuf/any.proto";

// Item represents a entry that gets inserted into the storage packer
message Item {
	// ID is the UUID to identify the item
	string id = 1;
	// message is the contents of the item
	google.protobuf.Any message = 2;
}

// BucketV2 is a construct to hold multiple items within itself. This
// abstraction contains multiple buckets of the same kind within itself and
// shares amont them the items that get inserted. When the bucket as a whole
// gets too big to hold more items, the contained buckets gets pushed out only
// to become independent buckets. Hence, this can grow infinitely in terms of
// storage space for items that get inserted.
message BucketV2{
	// Key is the storage path where the bucket gets stored
	string key = 1;
	// Buckets are the buckets contained within this bucket
	map <string, BucketV2> buckets = 2;
	// Items holds the items contained within this bucket
	map <string, Item> items = 3;
	// Sharded indicates if the buckets contained in this bucket are pushed out
	// or not
	bool sharded = 4;
	// Depth indicates the hierarchical positioning of this bucket
	int32 depth = 5;
	// Size of this bucket in number of bytes
	int64 size = 6;
}

message Bucket {
	string key = 1;
	repeated Item items = 2;
}
